<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day Clinic-Women's Health Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f6f7f8;
            color: #333;
        }
        .dashboard {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
        .header {
            background: white;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .logo-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo-text {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        .nav {
            display: flex;
            gap: 32px;
        }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            text-decoration: none;
            color: #666;
            border-radius: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .nav-item.active {
            background: #01f0d0;
            color: white;
        }
        .nav-item:hover:not(.active) {
            background: #f0f0f0;
        }
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .user-info {
            display: flex;
            flex-direction: column;
        }
        .user-name {
            font-weight: 600;
            font-size: 14px;
        }
        .user-title {
            font-size: 12px;
            color: #666;
        }
        .settings-btn,
        .more-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
        }
        .settings-btn:hover,
        .more-btn:hover {
            background: #f0f0f0;
        }
        .main-container {
            flex: 1;
            position: relative;
        }
        .content-section {
            display: none;
            padding: 20px;
        }
        .content-section.active {
            display: block;
        }
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .doctors-sidebar {
            background: white;
            border-radius: 16px;
            padding: 20px;
            height: fit-content;
        }
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .sidebar-header h2 {
            font-size: 24px;
            font-weight: 800;
        }
        .search-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            font-size: 16px;
        }
        .search-btn:hover {
            background: #f0f0f0;
        }
        .search-container {
            margin-bottom: 20px;
        }
        .search-container input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        .doctors-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 600px;
            overflow-y: auto;
        }
        .doctor-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
            position: relative;
        }
        .doctor-item:hover {
            background: #f8f9fa;
        }
        .doctor-item.active {
            background: #d8fcf7;
        }
        .doctor-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
        }
        .doctor-info {
            flex: 1;
        }
        .doctor-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
        }
        .doctor-details-text {
            font-size: 12px;
            color: #666;
        }
        .doctor-menu {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
        }
        .book-doctor-btn {
            background: #01f0d0;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            margin-left: auto;
            flex-shrink: 0;
        }
        .book-doctor-btn:hover {
            background: #00d4b4;
        }
        .dashboard-main {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .diagnosis-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
        }
        .diagnosis-section h2 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 20px;
        }
        .blood-pressure-card {
            background: #f4f0fe;
            border-radius: 12px;
            padding: 20px;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .card-header h3 {
            font-size: 18px;
            font-weight: 800;
        }
        .time-filter {
            padding: 8px 12px;
            border: none;
            border-radius: 20px;
            background: white;
            cursor: pointer;
        }
        .chart-container {
            height: 300px;
            margin-bottom: 20px;
        }
        .bp-legend {
            display: flex;
            gap: 40px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
        .legend-dot.systolic {
            background: #e66fd2;
        }
        .legend-dot.diastolic {
            background: #8c6fe6;
        }
        .legend-info {
            display: flex;
            flex-direction: column;
        }
        .legend-label {
            font-size: 14px;
            font-weight: 600;
        }
        .legend-value {
            font-size: 22px;
            font-weight: 800;
            margin: 4px 0;
        }
        .legend-status {
            font-size: 12px;
        }
        .vital-card.respiratory {
            background: #e0f2fe;
        }
        .vital-card.temperature {
            background: #ffe4e6;
        }
        .vital-card.heart-rate {
            background: #ffedd5;
        }
        .vital-icon {
            font-size: 48px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
        }
        .vital-info h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .vital-value {
            font-size: 30px;
            font-weight: 800;
            display: block;
            margin-bottom: 4px;
        }
        .vital-status {
            font-size: 14px;
        }
        .vital-status.normal {
            color: #059669;
        }
        .vital-status.lower {
            color: #8c6fe6;
        }
        .diagnostic-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
        }
        .diagnostic-section h2 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 20px;
        }
        .diagnostic-table {
            overflow-x: auto;
        }
        .diagnostic-table table {
            width: 100%;
            border-collapse: collapse;
        }
        .diagnostic-table th {
            text-align: left;
            padding: 12px;
            font-weight: 600;
            border-bottom: 1px solid #e5e7eb;
        }
        .diagnostic-table td {
            padding: 12px;
            border-bottom: 1px solid #f3f4f6;
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-badge.under-observation {
            background: #fef3c7;
            color: #92400e;
        }
        .status-badge.cured {
            background: #d1fae5;
            color: #065f46;
        }
        .status-badge.inactive {
            background: #f3f4f6;
            color: #6b7280;
        }
        .status-badge.completed {
            background: #d1fae5;
            color: #065f46;
        }
        .status-badge.pending {
            background: #fef3c7;
            color: #92400e;
        }
        .doctor-details {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .doctor-profile {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }
        .doctor-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 20px;
        }
        .doctor-name-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 30px;
        }
        .doctor-info-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            text-align: left;
        }
        .info-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .info-icon {
            width: 42px;
            height: 42px;
            background: #f0f9ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        .info-content {
            flex: 1;
        }
        .info-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 2px;
        }
        .info-value {
            font-size: 14px;
            font-weight: 600;
        }
        .show-info-btn {
            background: #01f0d0;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }
        .lab-results {
            background: white;
            border-radius: 16px;
            padding: 20px;
        }
        .lab-results h3 {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 20px;
        }
        .lab-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }
        .lab-item:last-child {
            border-bottom: none;
        }
        .lab-name {
            font-size: 14px;
            font-weight: 500;
        }
        .download-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
        }
        .download-btn:hover {
            background: #f3f4f6;
        }
        .overview-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        .overview-content h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 30px;
        }
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
        }
        .stat-card h3 {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }
        .stat-number {
            font-size: 36px;
            font-weight: 800;
            color: #01f0d0;
        }
        .schedule-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        .schedule-content h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 30px;
        }
        .calendar-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .nav-btn {
            background: #01f0d0;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e5e7eb;
        }
        .calendar-day {
            background: white;
            padding: 15px;
            text-align: center;
            cursor: pointer;
        }
        .calendar-day:hover {
            background: #f0f9ff;
        }
        .calendar-day.today {
            background: #01f0d0;
            color: white;
        }
        .calendar-day.past-month-day {
            background: #f0f0f0;
            color: #ccc;
            cursor: not-allowed;
        }
        .appointments-list {
            background: white;
            border-radius: 16px;
            padding: 20px;
        }
        .appointments-list h3 {
            margin-bottom: 20px;
        }
        .appointment-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
        }
        .appointment-item:last-child {
            border-bottom: none;
        }
        .time {
            font-weight: 600;
            color: #01f0d0;
        }
        .message-content {
            max-width: 800px;
            margin: 0 auto;
        }
        .message-content h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 30px;
        }
        .message-list {
            background: white;
            border-radius: 16px;
            padding: 20px;
        }
        .message-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
        }
        .message-item:hover {
            background: #f8f9fa;
        }
        .message-item.unread {
            background: #f0f9ff;
        }
        .message-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }
        .message-info h4 {
            margin-bottom: 5px;
        }
        .message-info p {
            color: #666;
            margin-bottom: 5px;
        }
        .message-time {
            font-size: 12px;
            color: #999;
        }
        /* General Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none; /* Hidden by default */
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        .modal-content h2 {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 25px;
            text-align: center;
            color: #333;
        }
        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        .modal-close-btn:hover {
            color: #333;
        }

        /* Booking Modal Specific Styles */
        .booking-form-group {
            margin-bottom: 18px;
        }
        .booking-form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }
        .booking-form-group input,
        .booking-form-group select,
        .booking-form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            color: #333;
            background-color: #f9f9f9;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .booking-form-group input:focus,
        .booking-form-group select:focus,
        .booking-form-group textarea:focus {
            border-color: #01f0d0;
            box-shadow: 0 0 0 3px rgba(1, 240, 208, 0.2);
            outline: none;
        }
        .booking-form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        .booking-form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }
        .booking-form-actions button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .booking-form-actions .cancel-btn {
            background: #e0e0e0;
            color: #555;
        }
        .booking-form-actions .cancel-btn:hover {
            background: #d0d0d0;
        }
        .booking-form-actions .submit-btn {
            background: #01f0d0;
            color: white;
        }
        .booking-form-actions .submit-btn:hover {
            background: #00d4b4;
        }

        /* Doctor Details Modal Specific Styles */
        .doctor-details-modal-content .doctor-profile-full {
            text-align: center;
        }
        .doctor-details-modal-content .doctor-profile-full img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
        }
        .doctor-details-modal-content .doctor-profile-full h3 {
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 10px;
        }
        .doctor-details-modal-content .doctor-profile-full p {
            font-size: 16px;
            color: #555;
            margin-bottom: 8px;
        }
        .doctor-details-modal-content .doctor-profile-full .detailed-specialities {
            font-style: italic;
            color: #777;
            margin-top: 15px;
            font-size: 14px;
        }

        /* Location Details Modal Specific Styles */
        .location-details-modal-content p {
            font-size: 18px;
            text-align: center;
            margin-top: 20px;
            font-weight: 600;
            color: #333;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 280px 1fr 320px;
            }
        }
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
            .doctors-sidebar,
            .doctor-details {
                order: 2;
            }
            .dashboard-main {
                order: 1;
            }
            .vitals-section {
                grid-template-columns: 1fr;
            }
        }
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 16px;
                padding: 16px;
            }
            .nav {
                flex-wrap: wrap;
                gap: 16px;
            }
            .content-section {
                padding: 16px;
            }
            .bp-legend {
                flex-direction: column;
                gap: 20px;
            }
            .modal-content {
                padding: 20px;
            }
            .modal-content h2 {
                font-size: 24px;
                margin-bottom: 20px;
            }
            .booking-form-actions {
                flex-direction: column;
                gap: 10px;
            }
            .booking-form-actions button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    &#9792; <!-- Unicode Female Sign -->
                </div>
                <span class="logo-text">Women's Health</span>
            </div>
            <nav class="nav">
                <a href="#" class="nav-item" onclick="showSection('overview')">
                    <span class="nav-icon">🏠</span>
                    Overview
                </a>
                <a href="#" class="nav-item active" onclick="showSection('doctors')">
                    <span class="nav-icon">👩‍⚕️</span>
                    Doctors
                </a>
                <a href="#" class="nav-item" onclick="showSection('schedule')">
                    <span class="nav-icon">📅</span>
                    Schedule
                </a>
                <a href="#" class="nav-item" onclick="showSection('message')">
                    <span class="nav-icon">💬</span>
                    Message
                </a>
            </nav>
        </header>
        <div class="main-container">
            <div id="doctors-section" class="content-section active">
                <div class="main-content">
                    <aside class="doctors-sidebar">
                        <div class="sidebar-header">
                            <h2>Doctors</h2>
                            <button class="search-btn" onclick="toggleSearch()">🔍</button>
                        </div>
                        <div class="search-container" id="searchContainer" style="display: none;">
                            <input type="text" id="doctorSearch" placeholder="Search doctors..." onkeyup="searchDoctors()">
                        </div>
                        <div class="doctors-list" id="doctorsList">
                            <div class="loading">Loading doctors...</div>
                        </div>
                    </aside>
                    <main class="dashboard-main">
                        <section class="diagnosis-section">
                            <h2>Doctor Client Statistics</h2>
                            <div class="blood-pressure-card">
                                <div class="card-header">
                                    <h3>Clients per Doctor</h3>
                                    <select class="time-filter" onchange="updateDoctorsChart(this.value)">
                                        <option value="March 2025">March 2025</option>
                                        <option value="February 2025">February 2025</option>
                                        <option value="January 2025">January 2025</option>
                                        <option value="December 2024">December 2024</option>
                                        <option value="November 2024">November 2024</option>
                                        <option value="October 2024">October 2024</option>
                                        <option value="September 2024">September 2024</option>
                                        <option value="August 2024">August 2024</option>
                                        <option value="July 2024">July 2024</option>
                                        <option value="June 2024">June 2024</option>
                                        <option value="May 2024">May 2024</option>
                                        <option value="April 2024">April 2024</option>
                                        <option value="March 2024">March 2024</option>
                                        <option value="February 2024">February 2024</option>
                                        <option value="January 2024">January 2024</option>
                                        <option value="December 2023">December 2023</option>
                                        <option value="November 2023">November 2023</option>
                                        <option value="October 2023">October 2023</option>
                                    </select>
                                </div>
                                <div class="chart-container">
                                    <canvas id="doctorsClientsChart"></canvas>
                                </div>
                            </div>
                        </section>
                    </main>
                    <aside class="doctor-details">
                        <div class="doctor-profile" id="doctorProfile">
                            <div class="loading">Loading doctor details...</div>
                        </div>
                    </aside>
                </div>
            </div>
            <div id="overview-section" class="content-section">
                <div class="overview-content">
                    <h1>Overview Dashboard</h1>
                    <div class="overview-stats">
                        <div class="stat-card">
                            <h3 id="totalPatientsHelpedTitle">Total Patients Helped by All Doctors</h3>
                            <span class="stat-number" id="totalPatientsHelpedValue">0</span>
                        </div>
                        <div class="stat-card">
                            <h3>Appointments Today</h3>
                            <span class="stat-number">23</span>
                        </div>
                        <div class="stat-card">
                            <h3>Critical Cases</h3>
                            <span class="stat-number">5</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="schedule-section" class="content-section">
                <div class="schedule-content">
                    <h1>Schedule & Calendar</h1>
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button onclick="previousMonth()" class="nav-btn">◀</button>
                            <h2 id="currentMonth">December 2024</h2>
                            <button onclick="nextMonth()" class="nav-btn">▶</button>
                        </div>
                        <div class="calendar-grid" id="calendarGrid">
                        </div>
                    </div>
                </div>
            </div>
            <div id="message-section" class="content-section">
                <div class="message-content">
                    <h1>Messages</h1>
                    <div class="message-list">
                        <div class="message-item unread">
                            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b786?w=40&h=40&fit=crop&crop=face" alt="Jessica Taylor" class="message-avatar">
                            <div class="message-info">
                                <h4>Jessica Taylor</h4>
                                <p>Thank you for the consultation yesterday...</p>
                                <span class="message-time">2 hours ago</span>
                            </div>
                        </div>
                        <div class="message-item">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face" alt="Ryan Johnson" class="message-avatar">
                            <div class="message-info">
                                <h4>Ryan Johnson</h4>
                                <p>Can we reschedule my appointment?</p>
                                <span class="message-time">1 day ago</span>
                            </div>
                        </div>
                        <div class="message-item">
                            <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face" alt="Emily Williams" class="message-avatar">
                            <div class="message-info">
                                <h4>Emily Williams</h4>
                                <p>Lab results inquiry</p>
                                <span class="message-time">2 days ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Booking Modal -->
        <div id="bookingModal" class="modal-overlay">
            <div class="modal-content">
                <button class="modal-close-btn" onclick="closeBookingModal()">×</button>
                <h2>Book Appointment</h2>
                <form id="bookingForm">
                    <div class="booking-form-group">
                        <label for="bookingDoctor">Doctor</label>
                        <select id="bookingDoctor" name="doctor" required>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                    <div class="booking-form-group">
                        <label for="bookingDate">Date</label>
                        <input type="date" id="bookingDate" name="date" required>
                    </div>
                    <div class="booking-form-group">
                        <label for="patientName">Your Name</label>
                        <input type="text" id="patientName" name="patientName" required placeholder="e.g., Jane Doe">
                    </div>
                    <div class="booking-form-group">
                        <label for="patientContact">Your Email/Phone</label>
                        <input type="text" id="patientContact" name="patientContact" required placeholder="e.g., jane.doe@example.com or 0712345678">
                    </div>
                    <div class="booking-form-group">
                        <label for="reason">Reason for Appointment</label>
                        <textarea id="reason" name="reason" rows="4" placeholder="Briefly describe your reason for booking..."></textarea>
                    </div>
                    <div class="booking-form-actions">
                        <button type="button" class="cancel-btn" onclick="closeBookingModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Book Now</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Doctor Details Modal -->
        <div id="doctorDetailsModal" class="modal-overlay">
            <div class="modal-content doctor-details-modal-content">
                <button class="modal-close-btn" onclick="closeDoctorDetailsModal()">×</button>
                <h2>Doctor Details</h2>
                <div id="doctorDetailsContent" class="doctor-profile-full">
                    <!-- Doctor details will be loaded here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Location Details Modal -->
        <div id="locationDetailsModal" class="modal-overlay">
            <div class="modal-content location-details-modal-content">
                <button class="modal-close-btn" onclick="closeLocationDetailsModal()">×</button>
                <h2>Exact Location</h2>
                <p id="exactLocationText"></p>
            </div>
        </div>

    </div>
    <script>
        let doctorsData = []
        let selectedDoctorData = null
        let doctorsClientsChart = null

        let currentCalendarMonth = new Date().getMonth()
        let currentCalendarYear = new Date().getFullYear()

        document.addEventListener("DOMContentLoaded", () => {
            fetchDoctorsData()
            generateCalendar()
            document.getElementById("bookingForm").addEventListener("submit", handleBookingSubmit)
        })

        async function fetchDoctorsData() {
            loadMockData()
        }

        function loadMockData() {
            const mockDoctorsData = [
                {
                    name: "Dr. Zola Mkhize",
                    speciality: "Gynecologist",
                    detailed_specialities: "Obstetrics, Reproductive Endocrinology, Infertility",
                    location: "Cape Town, Western Cape",
                    exact_address: "Mediclinic Cape Town, 21 Hof St, Gardens, Cape Town, 8001",
                    profile_picture: "https://i.pinimg.com/1200x/14/e6/34/14e634812e5c604f61c72776a8a92604.jpg",
                    phone_number: "(021) 123-4567",
                    email: "zola.mkhize@mediclinic.co.za",
                    years_of_experience: 15,
                    total_patients_helped: 1250,
                    clients_per_month: [
                        { month: "March", year: 2024, clients: 55 }, { month: "April", year: 2024, clients: 58 }, { month: "May", year: 2024, clients: 50 }, { month: "June", year: 2024, clients: 60 }, { month: "July", year: 2024, clients: 53 }, { month: "August", year: 2024, clients: 57 }, { month: "September", year: 2024, clients: 52 }, { month: "October", year: 2024, clients: 59 }, { month: "November", year: 2024, clients: 54 }, { month: "December", year: 2024, clients: 61 },
                        { month: "January", year: 2025, clients: 65 }, { month: "February", year: 2025, clients: 60 }, { month: "March", year: 2025, clients: 68 },
                    ],
                },
                {
                    name: "Dr. Lerato Ndlovu",
                    speciality: "Gynecologist",
                    detailed_specialities: "General Gynecology, Family Planning, Adolescent Health",
                    location: "Johannesburg, Gauteng",
                    exact_address: "Netcare Milpark Hospital, 9 Guild Rd, Parktown, Johannesburg, 2193",
                    profile_picture: "https://i.pinimg.com/736x/a9/21/7f/a9217f43edd88f18a5bdbc480aa4d8e4.jpg",
                    phone_number: "(011) 987-6543",
                    email: "lerato.ndlovu@netcare.co.za",
                    years_of_experience: 10,
                    total_patients_helped: 980,
                    clients_per_month: [
                        { month: "March", year: 2024, clients: 62 }, { month: "April", year: 2024, clients: 65 }, { month: "May", year: 2024, clients: 58 }, { month: "June", year: 2024, clients: 68 }, { month: "July", year: 2024, clients: 60 }, { month: "August", year: 2024, clients: 64 }, { month: "September", year: 2024, clients: 59 }, { month: "October", year: 2024, clients: 66 }, { month: "November", year: 2024, clients: 61 }, { month: "December", year: 2024, clients: 69 },
                        { month: "January", year: 2025, clients: 72 }, { month: "February", year: 2025, clients: 68 }, { month: "March", year: 2025, clients: 75 },
                    ],
                },
                {
                    name: "Dr. Sipho Dlamini",
                    speciality: "Gynecologist",
                    detailed_specialities: "Minimally Invasive Surgery, Urogynecology, Pelvic Floor Disorders",
                    location: "Durban, KwaZulu-Natal",
                    exact_address: "Life Entabeni Hospital, 148 South Ridge Rd, Berea, Durban, 4001",
                    profile_picture: "https://i.pinimg.com/736x/7e/83/0e/7e830e9c49dee63d546ba2b376523d30.jpg",
                    phone_number: "(031) 234-5678",
                    email: "sipho.dlamini@mediclinic.co.za",
                    years_of_experience: 8,
                    total_patients_helped: 720,
                    clients_per_month: [
                        { month: "March", year: 2024, clients: 40 }, { month: "April", year: 2024, clients: 42 }, { month: "May", year: 2024, clients: 38 }, { month: "June", year: 2024, clients: 45 }, { month: "July", year: 2024, clients: 39 }, { month: "August", year: 2024, clients: 43 }, { month: "September", year: 2024, clients: 37 }, { month: "October", year: 2024, clients: 44 }, { month: "November", year: 2024, clients: 38 }, { month: "December", year: 2024, clients: 46 },
                        { month: "January", year: 2025, clients: 48 }, { month: "February", year: 2025, clients: 45 }, { month: "March", year: 2025, clients: 50 },
                    ],
                },
                {
                    name: "Dr. Thandiwe Khumalo",
                    speciality: "Gynecologist",
                    detailed_specialities: "High-Risk Pregnancy, Maternal-Fetal Medicine, Prenatal Diagnosis",
                    location: "Pretoria, Gauteng",
                    exact_address: "Mediclinic Medforum, 241 Pretorius St, Arcadia, Pretoria, 0007",
                    profile_picture: "https://i.pinimg.com/1200x/ed/ee/0c/edee0cc644104700527fdad210cdb588.jpg",
                    phone_number: "(012) 345-6789",
                    email: "thandiwe.khumalo@mediclinic.co.za",
                    years_of_experience: 12,
                    total_patients_helped: 1100,
                    clients_per_month: [
                        { month: "March", year: 2024, clients: 48 }, { month: "April", year: 2024, clients: 50 }, { month: "May", year: 2024, clients: 45 }, { month: "June", year: 2024, clients: 52 }, { month: "July", year: 2024, clients: 47 }, { month: "August", year: 2024, clients: 49 }, { month: "September", year: 2024, clients: 46 }, { month: "October", year: 2024, clients: 51 }, { month: "November", year: 2024, clients: 48 }, { month: "December", year: 2024, clients: 53 },
                        { month: "January", year: 2025, clients: 55 }, { month: "February", year: 2025, clients: 52 }, { month: "March", year: 2025, clients: 58 },
                    ],
                },
                {
                    name: "Dr. Naheem Mohmad",
                    speciality: "Gynecologist",
                    detailed_specialities: "Menopause Management, Hormone Replacement Therapy, Osteoporosis",
                    location: "Port Elizabeth, Eastern Cape",
                    exact_address: "Life St George's Hospital, 40 Park Dr, Port Elizabeth, 6001",
                    profile_picture: "https://i.pinimg.com/736x/a3/1b/2e/a31b2ee2bdf3a8c5e65f99d935e64055.jpg",
                    phone_number: "(041) 555-1111",
                    email: "nomusa.mthembu@lifegeorge.co.za",
                    years_of_experience: 7,
                    total_patients_helped: 650,
                    clients_per_month: [
                        { month: "March", year: 2024, clients: 30 }, { month: "April", year: 2024, clients: 32 }, { month: "May", year: 2024, clients: 28 }, { month: "June", year: 2024, clients: 35 }, { month: "July", year: 2024, clients: 29 }, { month: "August", year: 2024, clients: 33 }, { month: "September", year: 2024, clients: 27 }, { month: "October", year: 2024, clients: 34 }, { month: "November", year: 2024, clients: 28 }, { month: "December", year: 2024, clients: 36 },
                        { month: "January", year: 2025, clients: 38 }, { month: "February", year: 2025, clients: 35 }, { month: "March", year: 2025, clients: 40 },
                    ],
                },
            ]
            doctorsData = mockDoctorsData.filter(doctor => doctor.speciality === "Gynecologist")
            selectedDoctorData = doctorsData.find((doctor) => doctor.name === "Dr. Sipho Dlamini") || doctorsData[0]
            if (selectedDoctorData) {
                renderDoctorsList()
                renderSelectedDoctorData()
                const timeFilterSelect = document.querySelector('.time-filter');
                const defaultMonth = timeFilterSelect.querySelector('option[value="March 2025"]') ? "March 2025" : timeFilterSelect.value;
                setTimeout(() => updateDoctorsChart(defaultMonth), 100);
                renderOverviewStats();
            } else {
                showError("No gynecologist data found.")
            }
        }

        function showSection(sectionName) {
            document.querySelectorAll(".content-section").forEach((section) => {
                section.classList.remove("active")
            })
            document.querySelectorAll(".nav-item").forEach((item) => {
                item.classList.remove("active")
            })
            document.getElementById(`${sectionName}-section`).classList.add("active")
            event.currentTarget.classList.add("active")
            if (sectionName === 'overview') {
                renderOverviewStats();
            }
        }

        function toggleSearch() {
            const searchContainer = document.getElementById("searchContainer")
            const searchInput = document.getElementById("doctorSearch")
            if (searchContainer.style.display === "none") {
                searchContainer.style.display = "block"
                searchInput.focus()
            } else {
                searchContainer.style.display = "none"
                searchInput.value = ""
                renderDoctorsList()
            }
        }

        function searchDoctors() {
            const searchTerm = document.getElementById("doctorSearch").value.toLowerCase()
            const filteredDoctors = doctorsData.filter(
                (doctor) =>
                    doctor.name.toLowerCase().includes(searchTerm) ||
                    doctor.speciality.toLowerCase().includes(searchTerm) ||
                    doctor.location.toLowerCase().includes(searchTerm)
            )
            renderDoctorsList(filteredDoctors)
        }

        function generateCalendar() {
            const calendarGrid = document.getElementById("calendarGrid")
            const currentMonthElement = document.getElementById("currentMonth")
            if (!calendarGrid || !currentMonthElement) return

            const months = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December",
            ]
            currentMonthElement.textContent = `${months[currentCalendarMonth]} ${currentCalendarYear}`

            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1).getDay()
            const daysInMonth = new Date(currentCalendarYear, currentCalendarMonth + 1, 0).getDate()
            const today = new Date()
            const currentMonthDate = new Date(today.getFullYear(), today.getMonth(), 1);
            const calendarMonthDate = new Date(currentCalendarYear, currentCalendarMonth, 1);

            let calendarHTML = ""
            const dayHeaders = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
            dayHeaders.forEach((day) => {
                calendarHTML += `<div class="calendar-day" style="font-weight: bold; background: #f8f9fa;">${day}</div>`
            })

            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day" style="color: #ccc;"></div>'
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const isToday =
                    today.getDate() === day &&
                    today.getMonth() === currentCalendarMonth &&
                    today.getFullYear() === currentCalendarYear
                const isPastMonth = calendarMonthDate < currentMonthDate;
                const isPastDayInCurrentMonth = !isPastMonth && (currentCalendarYear === today.getFullYear() && currentCalendarMonth === today.getMonth() && day < today.getDate());
                const todayClass = isToday ? "today" : ""
                const pastClass = (isPastMonth || isPastDayInCurrentMonth) ? "past-month-day" : "";
                const onClickHandler = (isPastMonth || isPastDayInCurrentMonth) ? '' : `onclick="openBookingModal(null, '${currentCalendarYear}-${String(currentCalendarMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}')"`;
                calendarHTML += `<div class="calendar-day ${todayClass} ${pastClass}" ${onClickHandler}>${day}</div>`
            }
            calendarGrid.innerHTML = calendarHTML
        }

        function previousMonth() {
            if (currentCalendarMonth === 0) {
                currentCalendarMonth = 11
                currentCalendarYear--
            } else {
                currentCalendarMonth--
            }
            generateCalendar()
        }

        function nextMonth() {
            if (currentCalendarMonth === 11) {
                currentCalendarMonth = 0
                currentCalendarYear++
            } else {
                currentCalendarMonth++
            }
            generateCalendar()
        }

        function updateDoctorsChart(monthYear) {
            const [monthName, year] = monthYear.split(' ');
            const chartData = doctorsData.map(doctor => {
                const clientData = doctor.clients_per_month.find(c => c.month === monthName && c.year === parseInt(year));
                return {
                    name: doctor.name,
                    clients: clientData ? clientData.clients : 0
                };
            }).sort((a, b) => b.clients - a.clients);

            const ctx = document.getElementById("doctorsClientsChart")
            if (!ctx) return

            const labels = chartData.map((item) => item.name)
            const clients = chartData.map((item) => item.clients)

            if (doctorsClientsChart) {
                doctorsClientsChart.destroy()
            }

            doctorsClientsChart = new Chart(ctx, {
                type: "bar",
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: `Clients in ${monthYear}`,
                            data: clients,
                            backgroundColor: "#01F0D0",
                            borderColor: "#01F0D0",
                            borderWidth: 1,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: "rgba(0, 0, 0, 0.8)",
                            titleColor: "white",
                            bodyColor: "white",
                            borderColor: "rgba(255, 255, 255, 0.1)",
                            borderWidth: 1,
                            callbacks: {
                                title: (context) => context[0].label,
                                label: (context) => `Clients: ${context.parsed.y}`,
                            },
                        },
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { color: "#6B7280" },
                        },
                        y: {
                            beginAtZero: true,
                            grid: { color: "rgba(0, 0, 0, 0.1)" },
                            ticks: { color: "#6B7280", stepSize: 10 },
                        },
                    },
                },
            })
        }

        function renderDoctorsList(doctors = doctorsData) {
            const doctorsList = document.getElementById("doctorsList")
            if (!doctors || doctors.length === 0) {
                doctorsList.innerHTML = '<div class="error">No doctors found</div>'
                return
            }
            const doctorsHTML = doctors
                .map(
                    (doctor) => `
                        <div class="doctor-item ${doctor.name === selectedDoctorData?.name ? "active" : ""}"
                            onclick="selectDoctor('${doctor.name}')">
                            <img src="${doctor.profile_picture}" alt="${doctor.name}" class="doctor-avatar"
                                onerror="this.src='/placeholder.svg?height=48&width=48'">
                            <div class="doctor-info">
                                <div class="doctor-name">${doctor.name}</div>
                                <div class="doctor-details-text">${doctor.speciality}, ${doctor.location}</div>
                            </div>
                            <button class="book-doctor-btn" onclick="event.stopPropagation(); openBookingModal('${doctor.name}')">Book</button>
                        </div>
                    `,
                )
                .join("")
            doctorsList.innerHTML = doctorsHTML
        }

        function renderSelectedDoctorData() {
            if (!selectedDoctorData) return
            renderDoctorProfile()
            renderOverviewStats();
        }

        function renderDoctorProfile() {
            const doctorProfile = document.getElementById("doctorProfile")
            doctorProfile.innerHTML = `
                <img src="${selectedDoctorData.profile_picture}" alt="${selectedDoctorData.name}" class="doctor-photo"
                    onerror="this.src='/placeholder.svg?height=200&width=200'">
                <h2 class="doctor-name-title">${selectedDoctorData.name}</h2>
                <div class="doctor-info-grid">
                    <div class="info-row">
                        <div class="info-icon">👩‍⚕️</div>
                        <div class="info-content">
                            <div class="info-label">Speciality</div>
                            <div class="info-value">${selectedDoctorData.speciality}</div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-icon">📍</div>
                        <div class="info-content">
                            <div class="info-label">Location</div>
                            <div class="info-value" style="cursor: pointer; text-decoration: underline;" onclick="openLocationDetailsModal('${selectedDoctorData.exact_address}')">${selectedDoctorData.location}</div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-icon">📞</div>
                        <div class="info-content">
                            <div class="info-label">Contact Info.</div>
                            <div class="info-value">${selectedDoctorData.phone_number}</div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-icon">📧</div>
                        <div class="info-content">
                            <div class="info-label">Email</div>
                            <div class="info-value">${selectedDoctorData.email}</div>
                        </div>
                    </div>
                    <div class="info-row">
                        <div class="info-icon">⭐</div>
                        <div class="info-content">
                            <div class="info-label">Years of Experience</div>
                            <div class="info-value">${selectedDoctorData.years_of_experience}</div>
                        </div>
                    </div>
                </div>
                <button class="show-info-btn" onclick="openDoctorDetailsModal()">Show All Information</button>
            `
        }

        function selectDoctor(doctorName) {
            document.querySelectorAll(".doctor-item").forEach((item) => {
                item.classList.remove("active")
            })
            event.currentTarget.classList.add("active")
            const selected = doctorsData.find((doctor) => doctor.name === doctorName)
            if (selected) {
                selectedDoctorData = selected
                renderSelectedDoctorData()
                const currentMonthInChart = document.querySelector('.time-filter').value;
                setTimeout(() => updateDoctorsChart(currentMonthInChart), 100)
            } else {
                alert(`Selected ${doctorName}. This doctor may not have complete data available.`)
            }
        }

        function downloadLabResult(labName) {
            alert(`Downloading ${labName}...\n\nNote: This is a demo implementation.`)
        }

        function renderOverviewStats() {
            const totalPatientsHelpedTitle = document.getElementById("totalPatientsHelpedTitle");
            const totalPatientsHelpedValue = document.getElementById("totalPatientsHelpedValue");

            // Calculate total patients helped by all doctors
            const totalPatientsAcrossAllDoctors = doctorsData.reduce((sum, doctor) => sum + (doctor.total_patients_helped || 0), 0);

            totalPatientsHelpedTitle.textContent = "Total Patients Helped by All Doctors";
            totalPatientsHelpedValue.textContent = totalPatientsAcrossAllDoctors.toLocaleString();
        }

        function showError(message) {
            const doctorsList = document.getElementById("doctorsList")
            doctorsList.innerHTML = `<div class="error">Error: ${message}</div>`
            const doctorProfile = document.getElementById("doctorProfile")
            doctorProfile.innerHTML = `<div class="error">Error loading doctor data: ${message}</div>`
        }

        // --- Booking Modal Functions ---
        function openBookingModal(doctorName = null, date = null) {
            const bookingModal = document.getElementById('bookingModal');
            const bookingDoctorSelect = document.getElementById('bookingDoctor');
            const bookingDateInput = document.getElementById('bookingDate');

            // Clear previous options and populate doctor dropdown
            bookingDoctorSelect.innerHTML = '';
            doctorsData.forEach(doctor => {
                const option = document.createElement('option');
                option.value = doctor.name;
                option.textContent = doctor.name;
                bookingDoctorSelect.appendChild(option);
            });

            // Pre-select doctor if provided
            if (doctorName) {
                bookingDoctorSelect.value = doctorName;
            } else if (selectedDoctorData) {
                // If no specific doctor, but one is selected in the sidebar, pre-select that one
                bookingDoctorSelect.value = selectedDoctorData.name;
            } else {
                // Otherwise, select the first doctor in the list
                bookingDoctorSelect.selectedIndex = 0;
            }

            // Pre-fill date if provided
            if (date) {
                bookingDateInput.value = date;
            } else {
                // Clear date if not provided
                bookingDateInput.value = '';
            }

            bookingModal.style.display = 'flex'; // Show the modal
        }

        function closeBookingModal() {
            document.getElementById('bookingModal').style.display = 'none'; // Hide the modal
            document.getElementById('bookingForm').reset(); // Reset the form fields
        }

        async function handleBookingSubmit(event) {
            event.preventDefault(); // Prevent default form submission

            const doctor = document.getElementById('bookingDoctor').value;
            const date = document.getElementById('bookingDate').value;
            const patientName = document.getElementById('patientName').value;
            const patientContact = document.getElementById('patientContact').value;
            const reason = document.getElementById('reason').value;

            try {
                const response = await fetch("/api/submit-booking", { // Changed URL to relative API path
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        doctor,
                        date,
                        patientName,
                        patientContact,
                        reason,
                    }),
                });

                const result = await response.json();

                if (response.ok) {
                    alert(`Booking successful! ${result.message}`);
                    closeBookingModal();
                } else {
                    alert(`Booking failed: ${result.error || result.message}`);
                }
            } catch (error) {
                console.error("Error submitting booking:", error);
                alert("An error occurred while booking. Please try again.");
            }
        }

        // --- Doctor Details Modal Functions ---
        function openDoctorDetailsModal() {
            const doctorDetailsModal = document.getElementById('doctorDetailsModal');
            const doctorDetailsContent = document.getElementById('doctorDetailsContent');

            if (!selectedDoctorData) {
                doctorDetailsContent.innerHTML = '<p>No doctor selected for details.</p>';
                doctorDetailsModal.style.display = 'flex';
                return;
            }

            doctorDetailsContent.innerHTML = `
                <img src="${selectedDoctorData.profile_picture}" alt="${selectedDoctorData.name}" onerror="this.src='/placeholder.svg?height=150&width=150'">
                <h3>${selectedDoctorData.name}</h3>
                <p><strong>Speciality:</strong> ${selectedDoctorData.speciality}</p>
                <p class="detailed-specialities">(${selectedDoctorData.detailed_specialities || 'N/A'})</p>
                <p><strong>Location:</strong> ${selectedDoctorData.location}</p>
                <p><strong>Exact Address:</strong> ${selectedDoctorData.exact_address || 'N/A'}</p>
                <p><strong>Contact:</strong> ${selectedDoctorData.phone_number}</p>
                <p><strong>Email:</strong> ${selectedDoctorData.email}</p>
                <p><strong>Years of Experience:</strong> ${selectedDoctorData.years_of_experience}</p>
                <p><strong>Total Patients Helped:</strong> ${selectedDoctorData.total_patients_helped.toLocaleString()}</p>
            `;
            doctorDetailsModal.style.display = 'flex';
        }

        function closeDoctorDetailsModal() {
            document.getElementById('doctorDetailsModal').style.display = 'none';
        }

        // --- Location Details Modal Functions ---
        function openLocationDetailsModal(address) {
            const locationDetailsModal = document.getElementById('locationDetailsModal');
            const exactLocationText = document.getElementById('exactLocationText');

            exactLocationText.textContent = address || 'Address not available.';
            locationDetailsModal.style.display = 'flex';
        }

        function closeLocationDetailsModal() {
            document.getElementById('locationDetailsModal').style.display = 'none';
        }
    </script>
</body>
</html>
